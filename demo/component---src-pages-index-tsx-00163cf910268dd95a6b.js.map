{"version":3,"sources":["webpack:///./src/img/flask.svg","webpack:///./src/elements/netspeak-corpus-selector.tsx","webpack:///./src/elements/additional-view-selector.tsx","webpack:///./src/lib/query-history.ts","webpack:///./src/lib/hash.ts","webpack:///./src/page-elements/search-page.tsx","webpack:///./src/pages/index.tsx"],"names":["module","exports","NetspeakCorpusSelector","props","corpora","defaultSorting","l","createLocalizer","locales","handleButtonClick","e","corpusKey","currentTarget","value","corpus","find","c","key","Error","onCorpusSelected","sorted","sort","a","b","indexA","indexOf","language","indexB","length","selectedCorpus","selected","defaultCorpus","setTimeout","buttons","map","classList","push","unavailable","has","className","join","onClick","name","toLowerCase","en","de","AdditionalViewSelector","onClicked","active","src","FlaskImage","alt","hideEXP","showEXP","QueryHistory","items","query","this","some","i","filter","limit","maxLength","slice","toJSON","JSON","stringify","fromJSON","json","parse","listeners","Set","callAllListeners","forEach","lastHash","undefined","window","addEventListener","location","hash","setInterval","KNOWN_CORPORA","SearchPage","lang","getCurrentLang","state","withCorpus","getPageParam","unavailableCorpora","storedQuery","showExperimental","refreshSearch","pageQuery","currentQuery","queryId","nextId","exampleVisibility","loadExampleVisibility","_onHashUpdateHandler","pageCorpus","setState","currentCorpusKey","_onCorpusSelectedHandler","setPageParam","_onQueryCommitHandler","history","trim","storyQueryHistory","_onSetExampleVisibilityHandler","visibility","storeExampleVisibility","_onShowExperimental","_onSearchRefreshed","_onSetQuery","s","componentDidMount","listener","_corporaPromise","CancelablePromise","Netspeak","instance","queryCorpora","then","info","available","ignoreCanceled","catch","reason","console","error","add","componentWillUnmount","cancel","delete","render","optional","defaultQuery","onSetQuery","onCommitQuery","forcedExperimentalQuery","onSearchRefreshed","defaultExampleVisibility","onSetExampleVisibility","pageSize","autoFocus","React","PureComponent","loadQueryHistory","getHashParams","URLSearchParams","substr","param","get","params","set","toString","setHashParams","stored","localStorage","getItem","setItem","sessionStorage","Home","dynamic","Helmet","content"],"mappings":"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","file":"component---src-pages-index-tsx-00163cf910268dd95a6b.js","sourcesContent":["module.exports = \"data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIKICAgICBmb2N1c2FibGU9ImZhbHNlIiBkYXRhLXByZWZpeD0iZmFzIiBkYXRhLWljb249ImZsYXNrIgogICAgIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1mbGFzayBmYS13LTE0IgogICAgIHJvbGU9ImltZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgNDQ4IDUxMiI+CiAgICA8cGF0aCBmaWxsPSIjMDA3NGE4IgogICAgICAgICAgZD0iTTQzNy4yIDQwMy41TDMyMCAyMTVWNjRoOGMxMy4zIDAgMjQtMTAuNyAyNC0yNFYyNGMwLTEzLjMtMTAuNy0yNC0yNC0yNEgxMjBjLTEzLjMgMC0yNCAxMC43LTI0IDI0djE2YzAgMTMuMyAxMC43IDI0IDI0IDI0aDh2MTUxTDEwLjggNDAzLjVDLTE4LjUgNDUwLjYgMTUuMyA1MTIgNzAuOSA1MTJoMzA2LjJjNTUuNyAwIDg5LjQtNjEuNSA2MC4xLTEwOC41ek0xMzcuOSAzMjBsNDguMi03Ny42YzMuNy01LjIgNS44LTExLjYgNS44LTE4LjRWNjRoNjR2MTYwYzAgNi45IDIuMiAxMy4yIDUuOCAxOC40bDQ4LjIgNzcuNmgtMTcyeiI+PC9wYXRoPgo8L3N2Zz4=\"","import React from \"react\";\nimport \"./netspeak-corpus-selector.scss\";\nimport { LocalizableProps, Locales, SimpleLocale, createLocalizer } from \"../lib/localize\";\nimport { Corpus } from \"../lib/netspeak\";\n\ninterface Props extends LocalizableProps {\n\tselected?: string;\n\tcorpora: readonly Corpus[];\n\tunavailable: ReadonlySet<Corpus>;\n\tonCorpusSelected: (corpus: Corpus) => void;\n}\n\nexport default function NetspeakCorpusSelector(props: Props): JSX.Element {\n\tconst l = createLocalizer(props, locales);\n\tconst handleButtonClick = (e: React.MouseEvent<HTMLButtonElement>): void => {\n\t\tconst corpusKey = e.currentTarget.value;\n\t\tconst corpus = props.corpora.find(c => c.key === corpusKey);\n\t\tif (!corpus) {\n\t\t\tthrow new Error(`Cannot find corpus with key \"${corpusKey}\".`);\n\t\t}\n\t\tprops.onCorpusSelected(corpus);\n\t};\n\n\tconst sorted = sortedCorpora(props.corpora);\n\n\t// the selected corpus will be the one whose key is given or the first one\n\tlet selectedCorpus = sorted.find(c => c.key === props.selected);\n\tif (!selectedCorpus && sorted.length > 0) {\n\t\tconst defaultCorpus = sorted[0];\n\t\tselectedCorpus = defaultCorpus;\n\t\tsetTimeout(() => {\n\t\t\tprops.onCorpusSelected(defaultCorpus);\n\t\t}, 1);\n\t}\n\n\tconst buttons = sorted.map(corpus => {\n\t\tconst classList: string[] = [];\n\t\tif (corpus === selectedCorpus) {\n\t\t\tclassList.push(\"selected\");\n\t\t}\n\t\tif (props.unavailable.has(corpus)) {\n\t\t\tclassList.push(\"unavailable\");\n\t\t}\n\n\t\treturn (\n\t\t\t<button key={corpus.key} className={classList.join(\" \")} value={corpus.key} onClick={handleButtonClick}>\n\t\t\t\t{l((\"label-\" + corpus.name.toLowerCase()) as any) || corpus.name}\n\t\t\t</button>\n\t\t);\n\t});\n\n\treturn (\n\t\t<div className=\"NetspeakCorpusSelector\">\n\t\t\t<div className=\"wrapper\">{buttons}</div>\n\t\t</div>\n\t);\n}\n\nconst locales: Locales<SimpleLocale<\"label-english\" | \"label-german\">> = {\n\ten: {\n\t\t\"label-english\": \"English\",\n\t\t\"label-german\": \"German\",\n\t},\n\tde: {\n\t\t\"label-english\": \"Englisch\",\n\t\t\"label-german\": \"Deutsch\",\n\t},\n};\n\nfunction sortedCorpora(corpora: Iterable<Corpus>): Corpus[] {\n\tconst defaultSorting = [\"en\", \"de\"];\n\n\treturn [...corpora].sort((a, b) => {\n\t\tlet indexA = defaultSorting.indexOf(a.language);\n\t\tlet indexB = defaultSorting.indexOf(b.language);\n\t\tif (indexA === -1) indexA = defaultSorting.length;\n\t\tif (indexB === -1) indexB = defaultSorting.length;\n\t\treturn indexA - indexB;\n\t});\n}\n","import React from \"react\";\nimport \"./additional-view-selector.scss\";\nimport FlaskImage from \"../img/flask.svg\";\nimport { LocalizableProps, Locales, SimpleLocale, createLocalizer } from \"../lib/localize\";\n\ninterface Props extends LocalizableProps {\n\tactive: boolean;\n\tonClicked: () => void;\n}\n\nexport default function AdditionalViewSelector(props: Props): JSX.Element {\n\tconst l = createLocalizer(props, locales);\n\n\tconst handleButtonClick = (e: React.MouseEvent<HTMLButtonElement>): void => {\n\t\tprops.onClicked();\n\t};\n\n\treturn (\n\t\t<div className=\"AdditionalViewSelector\">\n\t\t\t<div className=\"wrapper\">\n\t\t\t\t<button onClick={handleButtonClick} value={props.active ? \"active\" : \"inactive\"}>\n\t\t\t\t\t<img className=\"view-button-image\" src={FlaskImage} alt={\" \"} />\n\t\t\t\t\t{props.active ? l(\"hideEXP\") : l(\"showEXP\")}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nconst locales: Locales<SimpleLocale<\"hideEXP\" | \"showEXP\">> = {\n\ten: {\n\t\thideEXP: \"Hide Beta Results\",\n\t\tshowEXP: \"Show Beta Results\",\n\t},\n\tde: {\n\t\thideEXP: \"Beta Ergebnisse ausblenden\",\n\t\tshowEXP: \"Beta Ergebnisse anzeigen\",\n\t},\n};\n","export class QueryHistory {\n\tconstructor(public readonly items: readonly string[] = []) {}\n\n\tpush(query: string): QueryHistory {\n\t\tif (this.items.some(i => i === query)) {\n\t\t\treturn new QueryHistory([query, ...this.items.filter(i => i !== query)]);\n\t\t} else {\n\t\t\treturn new QueryHistory([query, ...this.items]);\n\t\t}\n\t}\n\tlimit(maxLength: number): QueryHistory {\n\t\tif (this.items.length <= maxLength) {\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn new QueryHistory(this.items.slice(0, maxLength));\n\t\t}\n\t}\n\n\ttoJSON(): string {\n\t\treturn JSON.stringify(this.items);\n\t}\n\tstatic fromJSON(json: string): QueryHistory {\n\t\treturn new QueryHistory(JSON.parse(json));\n\t}\n}\n","export type Listener = () => void;\n\nconst listeners = new Set<Listener>();\nexport function addHashChangeListener(listener: Listener): void {\n\tlisteners.add(listener);\n}\nexport function removeHashChangeListener(listener: Listener): void {\n\tlisteners.delete(listener);\n}\n\nfunction callAllListeners(): void {\n\tlisteners.forEach(l => l());\n}\n\n// This will add a listener for the \"hashchange\" event and it will periodically check the hash in case the event didn't\n// fire for some reason (yes, that happens).\nlet lastHash: string | undefined = undefined;\nif (typeof window !== \"undefined\") {\n\twindow.addEventListener(\"hashchange\", () => {\n\t\tlastHash = location.hash;\n\t\tcallAllListeners();\n\t});\n\tsetInterval(() => {\n\t\tif (lastHash !== undefined) {\n\t\t\tconst hash = location.hash;\n\t\t\tif (lastHash !== hash) {\n\t\t\t\tlastHash = location.hash;\n\t\t\t\tcallAllListeners();\n\t\t\t}\n\t\t}\n\t}, 10);\n}\n","import React from \"react\";\nimport \"./search-page.scss\";\nimport NetspeakCorpusSelector from \"../elements/netspeak-corpus-selector\";\nimport AdditionalFeatureSelector from \"../elements/additional-view-selector\";\nimport { getCurrentLang } from \"../lib/localize\";\nimport { NetspeakSearch, ExampleVisibility } from \"../elements/netspeak-search\";\nimport { Corpus, CorporaInfo, Netspeak } from \"../lib/netspeak\";\nimport { CancelablePromise, ignoreCanceled } from \"../lib/cancelable-promise\";\nimport { optional, nextId } from \"../lib/util\";\nimport { QueryHistory } from \"../lib/query-history\";\nimport Page from \"./page\";\nimport { addHashChangeListener, removeHashChangeListener } from \"../lib/hash\";\n\nconst KNOWN_CORPORA: readonly Corpus[] = [\n\t{\n\t\tkey: \"web-en\",\n\t\tname: \"English\",\n\t\tlanguage: \"en\",\n\t},\n\t{\n\t\tkey: \"web-de\",\n\t\tname: \"German\",\n\t\tlanguage: \"de\",\n\t},\n];\nconst DEFAULT_CORPUS_KEY = \"web-en\";\n\ninterface State {\n\tcurrentCorpusKey: string;\n\tcorpora: readonly Corpus[];\n\tunavailableCorpora: ReadonlySet<Corpus>;\n\tstoredQuery: string;\n\n\tshowExperimental: boolean;\n\trefreshSearch: boolean; //set to true after pressing the showExperimental button to refresh the result list results\n\n\tpageQuery: string;\n\tcurrentQuery: string;\n\tqueryId: number;\n\n\thistory: QueryHistory;\n\n\texampleVisibility: ExampleVisibility;\n}\n\nexport default class SearchPage extends React.PureComponent<unknown, State> {\n\treadonly lang = getCurrentLang();\n\tprivate _corporaPromise: CancelablePromise<Readonly<CorporaInfo>> | undefined;\n\tstate: Readonly<State> = {\n\t\t...withCorpus(getPageParam(\"corpus\") || DEFAULT_CORPUS_KEY),\n\t\tcorpora: KNOWN_CORPORA,\n\t\tunavailableCorpora: new Set(),\n\t\tstoredQuery: \"\",\n\n\t\tshowExperimental: false,\n\t\trefreshSearch: false,\n\n\t\tpageQuery: getPageParam(\"q\") || \"\",\n\t\tcurrentQuery: \"\",\n\t\tqueryId: nextId(),\n\n\t\texampleVisibility: loadExampleVisibility() ?? \"peek\",\n\t};\n\n\tcomponentDidMount(): void {\n\t\tthis._corporaPromise = new CancelablePromise(Netspeak.instance.queryCorpora());\n\t\tthis._corporaPromise\n\t\t\t.then(info => {\n\t\t\t\tconst available = new Set(info.corpora.map(c => c.key));\n\n\t\t\t\tthis.setState(state => {\n\t\t\t\t\treturn { unavailableCorpora: new Set(state.corpora.filter(c => !available.has(c.key))) };\n\t\t\t\t});\n\t\t\t}, ignoreCanceled)\n\t\t\t.catch(reason => {\n\t\t\t\tthis.setState(state => {\n\t\t\t\t\treturn { unavailableCorpora: new Set(state.corpora) };\n\t\t\t\t});\n\n\t\t\t\tconsole.error(reason);\n\t\t\t});\n\n\t\taddHashChangeListener(this._onHashUpdateHandler);\n\t}\n\tcomponentWillUnmount(): void {\n\t\tthis._corporaPromise?.cancel();\n\n\t\tremoveHashChangeListener(this._onHashUpdateHandler);\n\t}\n\n\tprivate _onHashUpdateHandler = (): void => {\n\t\tconst pageQuery = getPageParam(\"q\") || \"\";\n\t\tconst pageCorpus = getPageParam(\"corpus\");\n\n\t\tthis.setState(state => ({\n\t\t\tpageQuery: pageQuery,\n\t\t\t...withCorpus(pageCorpus || state.currentCorpusKey, state),\n\n\t\t\tcurrentQuery: pageQuery,\n\t\t\tqueryId: pageQuery === state.pageQuery || pageQuery === state.currentQuery ? state.queryId : nextId(),\n\t\t}));\n\t};\n\tprivate _onCorpusSelectedHandler = (corpus: Corpus): void => {\n\t\tthis.setState(state => withCorpus(corpus.key, state));\n\t\tsetPageParam(\"corpus\", corpus.key);\n\t};\n\tprivate _onQueryCommitHandler = (query: string): void => {\n\t\tthis.setState(state => {\n\t\t\tlet history = state.history;\n\t\t\tif (query.trim()) {\n\t\t\t\t// query isn't just spaces\n\t\t\t\thistory = history.push(query);\n\t\t\t\tstoryQueryHistory(state.currentCorpusKey, history);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcurrentQuery: query,\n\t\t\t\thistory,\n\t\t\t};\n\t\t});\n\t\tsetPageParam(\"q\", query);\n\t};\n\tprivate _onSetExampleVisibilityHandler = (visibility: ExampleVisibility): void => {\n\t\tstoreExampleVisibility(visibility);\n\t\tthis.setState({\n\t\t\texampleVisibility: visibility,\n\t\t});\n\t};\n\tprivate _onShowExperimental = (): void => {\n\t\tthis.setState({ showExperimental: !this.state.showExperimental });\n\t\tthis.setState({ refreshSearch: true });\n\t};\n\tprivate _onSearchRefreshed = (): void => {\n\t\tthis.setState({ refreshSearch: false }); //sent to result list to be called after search is refreshed\n\t};\n\tprivate _onSetQuery = (s: string): void => {\n\t\tthis.setState({ storedQuery: s });\n\t\tthis.setState({ refreshSearch: true });\n\t};\n\n\trender(): JSX.Element {\n\t\treturn (\n\t\t\t<Page lang={this.lang} className=\"SearchPage\">\n\t\t\t\t<div className=\"section\">\n\t\t\t\t\t<div className=\"options-wrapper\">\n\t\t\t\t\t\t{optional(this.state.corpora.length > 0, () => (\n\t\t\t\t\t\t\t<NetspeakCorpusSelector\n\t\t\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\t\t\tselected={this.state.currentCorpusKey}\n\t\t\t\t\t\t\t\tcorpora={this.state.corpora}\n\t\t\t\t\t\t\t\tunavailable={this.state.unavailableCorpora}\n\t\t\t\t\t\t\t\tonCorpusSelected={this._onCorpusSelectedHandler}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className=\"search-wrapper\">\n\t\t\t\t\t\t<NetspeakSearch\n\t\t\t\t\t\t\tkey={this.state.queryId + \";\" + this.state.currentCorpusKey}\n\t\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\t\tcorpusKey={this.state.currentCorpusKey}\n\t\t\t\t\t\t\tdefaultQuery={this.state.pageQuery}\n\t\t\t\t\t\t\tonSetQuery={this._onSetQuery}\n\t\t\t\t\t\t\tonCommitQuery={this._onQueryCommitHandler}\n\t\t\t\t\t\t\tshowExperimental={false}\n\t\t\t\t\t\t\tforcedExperimentalQuery={\"\"}\n\t\t\t\t\t\t\trefreshSearch={this.state.refreshSearch}\n\t\t\t\t\t\t\tonSearchRefreshed={this._onSearchRefreshed}\n\t\t\t\t\t\t\thistory={this.state.history}\n\t\t\t\t\t\t\tdefaultExampleVisibility={this.state.exampleVisibility}\n\t\t\t\t\t\t\tonSetExampleVisibility={this._onSetExampleVisibilityHandler}\n\t\t\t\t\t\t\tpageSize={40}\n\t\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"section\">\n\t\t\t\t\t<div className=\"options-wrapper\">\n\t\t\t\t\t\t<AdditionalFeatureSelector\n\t\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\t\tactive={this.state.showExperimental}\n\t\t\t\t\t\t\tonClicked={this._onShowExperimental}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"search-wrapper\">\n\t\t\t\t\t\t{optional(this.state.showExperimental, () => (\n\t\t\t\t\t\t\t<NetspeakSearch\n\t\t\t\t\t\t\t\tkey={this.state.queryId + \";\" + this.state.currentCorpusKey}\n\t\t\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\t\t\tcorpusKey={this.state.currentCorpusKey}\n\t\t\t\t\t\t\t\tdefaultQuery={this.state.pageQuery}\n\t\t\t\t\t\t\t\tonSetQuery={this._onSetQuery}\n\t\t\t\t\t\t\t\tonCommitQuery={this._onQueryCommitHandler}\n\t\t\t\t\t\t\t\tshowExperimental={true}\n\t\t\t\t\t\t\t\tforcedExperimentalQuery={this.state.storedQuery}\n\t\t\t\t\t\t\t\trefreshSearch={this.state.refreshSearch}\n\t\t\t\t\t\t\t\tonSearchRefreshed={this._onSearchRefreshed}\n\t\t\t\t\t\t\t\thistory={this.state.history}\n\t\t\t\t\t\t\t\tdefaultExampleVisibility={\"hidden\"}\n\t\t\t\t\t\t\t\tonSetExampleVisibility={(): void => {\n\t\t\t\t\t\t\t\t\t/* do nothing */\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tpageSize={40}\n\t\t\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Page>\n\t\t);\n\t}\n}\n\nfunction withCorpus(corpusKey: string, state?: Readonly<State>): Pick<State, \"currentCorpusKey\" | \"history\"> {\n\treturn {\n\t\tcurrentCorpusKey: corpusKey,\n\t\thistory: state?.currentCorpusKey === corpusKey ? state.history : loadQueryHistory(corpusKey),\n\t};\n}\n\nfunction getHashParams(): URLSearchParams {\n\ttry {\n\t\treturn new URLSearchParams((location.hash || \"#\").substr(1));\n\t} catch (error) {\n\t\treturn new URLSearchParams(\"\");\n\t}\n}\nfunction setHashParams(params: URLSearchParams): void {\n\tlocation.hash = params.toString();\n}\ntype PageParam = \"q\" | \"corpus\";\nfunction getPageParam(param: PageParam): string | null {\n\treturn getHashParams().get(param);\n}\nfunction setPageParam(param: PageParam, value: string): void {\n\tconst params = getHashParams();\n\tparams.set(param, value);\n\tsetHashParams(params);\n}\n\nfunction loadQueryHistory(corpus: string): QueryHistory {\n\tconst stored = localStorage.getItem(\"queryHistory:\" + corpus);\n\tif (stored) {\n\t\treturn QueryHistory.fromJSON(stored);\n\t} else {\n\t\treturn new QueryHistory();\n\t}\n}\nfunction storyQueryHistory(corpus: string, history: QueryHistory): void {\n\tlocalStorage.setItem(\"queryHistory:\" + corpus, history.toJSON());\n}\n\nfunction loadExampleVisibility(): ExampleVisibility | null {\n\treturn sessionStorage.getItem(\"exampleVisibility\") as ExampleVisibility | null;\n}\nfunction storeExampleVisibility(value: ExampleVisibility): void {\n\tsessionStorage.setItem(\"exampleVisibility\", value);\n}\n","import React from \"react\";\nimport SearchPage from \"../page-elements/search-page\";\nimport { Helmet } from \"react-helmet\";\nimport dynamic from \"../lib/dynamic\";\nimport SharedHead from \"../page-elements/shared-head\";\n\nexport default function Home(): JSX.Element {\n\treturn (\n\t\t<>\n\t\t\t{dynamic(() => (\n\t\t\t\t<SearchPage />\n\t\t\t))}\n\t\t\t<SharedHead />\n\t\t\t<Helmet>\n\t\t\t\t<title>Netspeak</title>\n\t\t\t\t<meta\n\t\t\t\t\tname=\"keywords\"\n\t\t\t\t\tcontent=\"netspeak, common language, dictionary, phrase dictionary, netfreak, net speak, net-speak, net slang, internet slang, net-speak, writing assistant\"\n\t\t\t\t/>\n\t\t\t\t<meta\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tcontent=\"Netspeak helps you to search for words you don't know, yet. It is a new kind of dictionary that contains everything that has ever been written on the web.\"\n\t\t\t\t/>\n\t\t\t</Helmet>\n\t\t</>\n\t);\n}\n"],"sourceRoot":""}