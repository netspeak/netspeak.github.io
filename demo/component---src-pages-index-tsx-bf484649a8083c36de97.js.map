{"version":3,"sources":["webpack:///./src/elements/netspeak-corpus-selector.tsx","webpack:///./src/lib/query-history.ts","webpack:///./src/page-elements/search-page.tsx","webpack:///./src/pages/index.tsx"],"names":["NetspeakCorpusSelector","props","corpora","defaultSorting","l","createLocalizer","locales","handleButtonClick","e","corpusKey","currentTarget","value","onCorpusSelected","containsSelectedCorpus","some","c","key","selected","buttons","sort","a","b","indexA","indexOf","indexB","length","map","corpus","i","className","label","name","toLowerCase","onClick","en","de","QueryHistory","items","push","query","this","filter","limit","maxLength","slice","toJSON","JSON","stringify","fromJSON","json","parse","SearchPage","lang","getCurrentLang","state","withCorpusKey","getPageParam","pageQuery","currentQuery","queryId","nextId","exampleVisibility","localStorage","getItem","_onHashUpdateHandler","pageCorpus","setState","_onCorpusSelectedHandler","setPageParam","_onQueryCommitHandler","history","trim","storyQueryHistory","_onSetExampleVisibilityHandler","visibility","setItem","componentDidMount","_corporaPromise","CancelablePromise","Netspeak","instance","queryCorpora","then","info","default","defaultCorpus","ignoreCanceled","window","addEventListener","componentWillUnmount","cancel","removeEventListener","render","optional","defaultQuery","onCommitQuery","defaultExampleVisibility","onSetExampleVisibility","pageSize","React","PureComponent","loadQueryHistory","getHashParams","URLSearchParams","location","hash","substr","error","param","get","params","set","toString","setHashParams","stored","Home","Helmet","content"],"mappings":"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","file":"component---src-pages-index-tsx-bf484649a8083c36de97.js","sourcesContent":["import React from \"react\";\nimport \"./netspeak-corpus-selector.css\";\nimport { LocalizableProps, Locales, SimpleLocale, createLocalizer } from \"../lib/localize\";\nimport { Corpus } from \"../lib/netspeak\";\n\ninterface Props extends LocalizableProps {\n\tselected: string;\n\tcorpora: readonly Corpus[];\n\tonCorpusSelected: (corpusKey: string) => void;\n}\n\nexport default function NetspeakCorpusSelector(props: Props): JSX.Element {\n\tconst l = createLocalizer(props, locales);\n\tconst handleButtonClick = (e: React.MouseEvent<HTMLButtonElement>): void => {\n\t\tconst corpusKey = e.currentTarget.value;\n\t\tprops.onCorpusSelected(corpusKey);\n\t};\n\n\tconst containsSelectedCorpus = props.corpora.some(c => c.key === props.selected);\n\tconst buttons = sortedCorpora(props.corpora).map((corpus, i) => {\n\t\tconst selected = corpus.key === props.selected || (!containsSelectedCorpus && i === 0);\n\t\tconst className = selected ? \"selected\" : \"\";\n\t\tconst label = l((\"label-\" + corpus.name.toLowerCase()) as any) || corpus.name;\n\t\treturn (\n\t\t\t<button key={corpus.key} className={className} value={corpus.key} onClick={handleButtonClick}>\n\t\t\t\t{label}\n\t\t\t</button>\n\t\t);\n\t});\n\n\treturn (\n\t\t<div className=\"NetspeakCorpusSelector\">\n\t\t\t<div className=\"wrapper\">{buttons}</div>\n\t\t</div>\n\t);\n}\n\nconst locales: Locales<SimpleLocale<\"label-english\" | \"label-german\">> = {\n\ten: {\n\t\t\"label-english\": \"English\",\n\t\t\"label-german\": \"German\",\n\t},\n\tde: {\n\t\t\"label-english\": \"Englisch\",\n\t\t\"label-german\": \"Deutsch\",\n\t},\n};\n\nfunction sortedCorpora(corpora: Iterable<Corpus>): Corpus[] {\n\tconst defaultSorting = [\"web-en\", \"web-de\"];\n\n\treturn [...corpora].sort((a, b) => {\n\t\tlet indexA = defaultSorting.indexOf(a.key);\n\t\tlet indexB = defaultSorting.indexOf(b.key);\n\t\tif (indexA === -1) indexA = defaultSorting.length;\n\t\tif (indexB === -1) indexB = defaultSorting.length;\n\t\treturn indexA - indexB;\n\t});\n}\n","export class QueryHistory {\n\tconstructor(public readonly items: readonly string[] = []) {}\n\n\tpush(query: string): QueryHistory {\n\t\tif (this.items.some(i => i === query)) {\n\t\t\treturn new QueryHistory([query, ...this.items.filter(i => i !== query)]);\n\t\t} else {\n\t\t\treturn new QueryHistory([query, ...this.items]);\n\t\t}\n\t}\n\tlimit(maxLength: number): QueryHistory {\n\t\tif (this.items.length <= maxLength) {\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn new QueryHistory(this.items.slice(0, maxLength));\n\t\t}\n\t}\n\n\ttoJSON(): string {\n\t\treturn JSON.stringify(this.items);\n\t}\n\tstatic fromJSON(json: string): QueryHistory {\n\t\treturn new QueryHistory(JSON.parse(json));\n\t}\n}\n","import React from \"react\";\nimport \"./search-page.css\";\nimport NetspeakCorpusSelector from \"../elements/netspeak-corpus-selector\";\nimport { getCurrentLang } from \"../lib/localize\";\nimport { NetspeakSearch, ExampleVisibility } from \"../elements/netspeak-search\";\nimport { Corpus, CorporaInfo, Netspeak } from \"../lib/netspeak\";\nimport { CancelablePromise, ignoreCanceled } from \"../lib/cancelable-promise\";\nimport { optional, nextId } from \"../lib/util\";\nimport { QueryHistory } from \"../lib/query-history\";\nimport Page from \"./page\";\nimport { location, localStorage } from \"../lib/window-helper\";\n\ninterface State {\n\tcorpusKey: string;\n\tcorpora: readonly Corpus[];\n\n\tpageQuery: string;\n\tcurrentQuery: string;\n\tqueryId: number;\n\n\thistory: QueryHistory;\n\n\texampleVisibility: ExampleVisibility;\n}\n\nexport default class SearchPage extends React.PureComponent<unknown, State> {\n\treadonly lang = getCurrentLang();\n\tprivate _corporaPromise: CancelablePromise<Readonly<CorporaInfo>> | undefined;\n\tstate: Readonly<State> = {\n\t\t...withCorpusKey(getPageParam(\"corpus\") || \"\"),\n\t\tcorpora: [],\n\n\t\tpageQuery: getPageParam(\"q\") || \"\",\n\t\tcurrentQuery: \"\",\n\t\tqueryId: nextId(),\n\n\t\texampleVisibility: (localStorage?.getItem(\"exampleVisibility\") || \"peek\") as ExampleVisibility,\n\t};\n\n\tcomponentDidMount(): void {\n\t\tthis._corporaPromise = new CancelablePromise(Netspeak.instance.queryCorpora());\n\t\tthis._corporaPromise.then(info => {\n\t\t\tthis.setState(state => {\n\t\t\t\treturn {\n\t\t\t\t\t// set the corpus key here if not defined already\n\t\t\t\t\t...withCorpusKey(state.corpusKey || info.default || Netspeak.defaultCorpus, state),\n\t\t\t\t\tcorpora: info.corpora,\n\t\t\t\t};\n\t\t\t});\n\t\t}, ignoreCanceled);\n\n\t\twindow.addEventListener(\"hashchange\", this._onHashUpdateHandler);\n\t}\n\tcomponentWillUnmount(): void {\n\t\tthis._corporaPromise?.cancel();\n\n\t\twindow.removeEventListener(\"hashchange\", this._onHashUpdateHandler);\n\t}\n\n\tprivate _onHashUpdateHandler = (): void => {\n\t\tconst pageQuery = getPageParam(\"q\") || \"\";\n\t\tconst pageCorpus = getPageParam(\"corpus\");\n\n\t\tthis.setState(state => ({\n\t\t\tpageQuery: pageQuery,\n\t\t\t...withCorpusKey(pageCorpus ?? state.corpusKey, state),\n\n\t\t\tcurrentQuery: pageQuery,\n\t\t\tqueryId: pageQuery === state.pageQuery || pageQuery === state.currentQuery ? state.queryId : nextId(),\n\t\t}));\n\t};\n\tprivate _onCorpusSelectedHandler = (corpusKey: string): void => {\n\t\tthis.setState(state => withCorpusKey(corpusKey, state));\n\t\tsetPageParam(\"corpus\", corpusKey);\n\t};\n\tprivate _onQueryCommitHandler = (query: string): void => {\n\t\tthis.setState(state => {\n\t\t\tlet history = state.history;\n\t\t\tif (query.trim()) {\n\t\t\t\t// query isn't just spaces\n\t\t\t\thistory = history.push(query);\n\t\t\t\tstoryQueryHistory(state.corpusKey, history);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcurrentQuery: query,\n\t\t\t\thistory,\n\t\t\t};\n\t\t});\n\t\tsetPageParam(\"q\", query);\n\t};\n\tprivate _onSetExampleVisibilityHandler = (visibility: ExampleVisibility): void => {\n\t\tlocalStorage?.setItem(\"exampleVisibility\", visibility);\n\t\tthis.setState({\n\t\t\texampleVisibility: visibility,\n\t\t});\n\t};\n\n\trender(): JSX.Element {\n\t\treturn (\n\t\t\t<Page lang={this.lang}>\n\t\t\t\t{optional(this.state.corpora.length > 0, () => (\n\t\t\t\t\t<NetspeakCorpusSelector\n\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\tselected={this.state.corpusKey}\n\t\t\t\t\t\tcorpora={this.state.corpora}\n\t\t\t\t\t\tonCorpusSelected={this._onCorpusSelectedHandler}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t\t<div className=\"search-wrapper\">\n\t\t\t\t\t<NetspeakSearch\n\t\t\t\t\t\tkey={this.state.queryId + \";\" + this.state.corpusKey}\n\t\t\t\t\t\tlang={this.lang}\n\t\t\t\t\t\tcorpus={this.state.corpusKey}\n\t\t\t\t\t\tdefaultQuery={this.state.pageQuery}\n\t\t\t\t\t\tonCommitQuery={this._onQueryCommitHandler}\n\t\t\t\t\t\thistory={this.state.history}\n\t\t\t\t\t\tdefaultExampleVisibility={this.state.exampleVisibility}\n\t\t\t\t\t\tonSetExampleVisibility={this._onSetExampleVisibilityHandler}\n\t\t\t\t\t\tpageSize={40}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Page>\n\t\t);\n\t}\n}\n\nfunction withCorpusKey(corpusKey: string, state?: Readonly<State>): Pick<State, \"corpusKey\" | \"history\"> {\n\treturn {\n\t\tcorpusKey,\n\t\thistory: state?.corpusKey === corpusKey ? state.history : loadQueryHistory(corpusKey),\n\t};\n}\n\nfunction getHashParams(): URLSearchParams {\n\ttry {\n\t\treturn new URLSearchParams((location?.hash || \"#\").substr(1));\n\t} catch (error) {\n\t\treturn new URLSearchParams(\"\");\n\t}\n}\nfunction setHashParams(params: URLSearchParams): void {\n\tif (location) {\n\t\tlocation.hash = params.toString();\n\t}\n}\ntype PageParam = \"q\" | \"corpus\";\nfunction getPageParam(param: PageParam): string | null {\n\treturn getHashParams().get(param);\n}\nfunction setPageParam(param: PageParam, value: string): void {\n\tconst params = getHashParams();\n\tparams.set(param, value);\n\tsetHashParams(params);\n}\n\nfunction loadQueryHistory(corpus: string): QueryHistory {\n\tconst stored = localStorage?.getItem(\"queryHistory:\" + corpus);\n\tif (stored) {\n\t\treturn QueryHistory.fromJSON(stored);\n\t} else {\n\t\treturn new QueryHistory();\n\t}\n}\nfunction storyQueryHistory(corpus: string, history: QueryHistory): void {\n\tlocalStorage?.setItem(\"queryHistory:\" + corpus, history.toJSON());\n}\n","import React from \"react\";\nimport SearchPage from \"../page-elements/search-page\";\nimport { Helmet } from \"react-helmet\";\nimport GA from \"../page-elements/ga\";\n\nexport default function Home(): JSX.Element {\n\treturn (\n\t\t<>\n\t\t\t<SearchPage />\n\t\t\t<Helmet>\n\t\t\t\t<title>Netspeak</title>\n\t\t\t\t<meta\n\t\t\t\t\tname=\"keywords\"\n\t\t\t\t\tcontent=\"netspeak, common language, dictionary, phrase dictionary, netfreak, net speak, net-speak, net slang, internet slang, net-speak, writing assistant\"\n\t\t\t\t/>\n\t\t\t\t<meta\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tcontent=\"Netspeak helps you to search for words you don't know, yet. It is a new kind of dictionary that contains everything that has ever been written on the web.\"\n\t\t\t\t/>\n\t\t\t\t<GA />\n\t\t\t</Helmet>\n\t\t</>\n\t);\n}\n"],"sourceRoot":""}